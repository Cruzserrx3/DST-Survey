<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="cruzserrx3">
    <title>
      SURVEY-DST
    </title>
    <style>
        /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */
    html {
    line-height: 1.15;
    -webkit-text-size-adjust: 100%
    }

    body {
    margin: 0
    }

    main {
    display: block
    }

    h1 {
    font-size: 2em;
    margin: 0.67em 0
    }

    hr {
    box-sizing: content-box;
    height: 0;
    overflow: visible
    }

    pre {
    font-family: monospace, monospace;
    font-size: 1em
    }

    a {
    background-color: transparent
    }

    abbr[title] {
    border-bottom: none;
    text-decoration: underline;
    text-decoration: underline dotted
    }

    b, strong {
    font-weight: bolder
    }

    code, kbd, samp {
    font-family: monospace, monospace;
    font-size: 1em
    }

    small {
    font-size: 80%
    }

    sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline
    }

    sub {
    bottom: -0.25em
    }

    sup {
    top: -0.5em
    }

    img {
    border-style: none
    }

    button, input, optgroup, select, textarea {
    font-family: inherit;
    font-size: 100%;
    line-height: 1.15;
    margin: 0
    }

    button, input {
    overflow: visible
    }

    button, select {
    text-transform: none
    }

    [type="button"], [type="reset"], [type="submit"], button {
    -webkit-appearance: button
    }

    [type="button"]::-moz-focus-inner, [type="reset"]::-moz-focus-inner, [type="submit"]::-moz-focus-inner, button::-moz-focus-inner {
    border-style: none;
    padding: 0
    }

    [type="button"]:-moz-focusring, [type="reset"]:-moz-focusring, [type="submit"]:-moz-focusring, button:-moz-focusring {
    outline: 1px dotted ButtonText
    }

    fieldset {
    padding: 0.35em 0.75em 0.625em
    }

    legend {
    box-sizing: border-box;
    color: inherit;
    display: table;
    max-width: 100%;
    padding: 0;
    white-space: normal
    }

    progress {
    vertical-align: baseline
    }

    textarea {
    overflow: auto
    }

    [type="checkbox"], [type="radio"] {
    box-sizing: border-box;
    padding: 0
    }

    [type="number"]::-webkit-inner-spin-button, [type="number"]::-webkit-outer-spin-button {
    height: auto
    }

    [type="search"] {
    -webkit-appearance: textfield;
    outline-offset: -2px
    }

    [type="search"]::-webkit-search-decoration {
    -webkit-appearance: none
    }

    ::-webkit-file-upload-button {
    -webkit-appearance: button;
    font: inherit
    }

    details {
    display: block
    }

    summary {
    display: list-item
    }

    template {
    display: none
    }

    [hidden] {
    display: none
    }

    /* cruzserrx3 */
    * {-webkit-font-smoothing: antialiased;}

    .cruzserrx3 * {
    box-sizing: border-box;
    }

    .cruzserrx3 {
    box-sizing: border-box;
    font-family: "Arial", sans-serif;
    font-size: 14px;
    padding: 5px;
    width: 100%;
    }

    .cruzserrx3.loading {
    cursor: wait;
    }

    .application-align-center {
    margin: auto;
    }

    .application-align-right {
    margin-left: auto;
    margin-right: 0;
    }

    .application-layout-fixed .tabs {
    overflow-x: auto;
    }

    .application-layout-fit-parent {
    width: 100%;
    }

    .application-layout-fit-parent table {
    table-layout: auto;
    width: 100%;
    }

    .draw-frame {
    padding: 0;
    position: relative;
    z-index: 1;
    }

    .draw-frame-layout-fixed {
    margin: 0;
    position: absolute;
    }

    .draw-frame-layout-fluid,
    .draw-frame-layout-fit-parent {
    margin: 10px 0;
    width: 100%;
    }

    .chart {
    border: 1px solid #ebebeb;
    border-radius: 4px;
    padding: 4px;
    }

    table {
    table-layout: fixed;
    border: none;
    border-collapse: separate;
    border-spacing: 0 0;
    }

    tbody {
    border: none;
    }

    tr {
    min-height: 10px;
    }

    td {
    padding: 2px;
    line-height: normal;
    }

    td.out > div {
    padding: 4px 4px;
    }

    td.text {
    padding: 4px;
    }

    input,
    select {
    background: none;
    border: 1px solid #ccc;
    border-radius: 4px;
    color: inherit;
    padding: 4px;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    text-align: inherit;
    width: 100%;
    }

    input {
    vertical-align: text-bottom;
    }

    select {
    -webkit-appearance: none;
    -moz-appearance: none;
    background: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 4px center;
    background-size: 16px 12px;
    appearance: none;
    outline: 0;
    padding-right: 24px;
    }

    p {
    margin: 0;
    }

    .in {
    text-align: right;
    }
    .in select {
    text-align-last: right;
    }

    .in--text {
    text-align: left;
    }

    .in--text select {
    text-align-last: left;
    }

    .out {
    text-align: right;
    }

    .out--text {
    text-align: left;
    }

    .help-text {
    color: #6c757d;
    font-size: 0.7rem;
    margin-top: .25rem;
    padding: 0;
    text-align: left;
    }

    .hidden-cell {
    display: none;
    }

    .hidden-row {
    display: none;
    }

    textarea {
    background: #ffffff;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    resize: none;
    width: 100%;
    }

    .btn {
    background-color: white;
    border: 1px solid #ebebeb;
    border-radius: 3px;
    color: black;
    padding: 5px 10px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    font-family: inherit;
    }

    .action-bar {
    border-top: 1px solid #d4d4d1;
    margin-top: 10px;
    padding-top: 10px;
    }

    .tabs {
    margin-bottom: 10px;
    padding: 10px 0;
    position: relative;
    }

    .tab-content {
    padding: 0 10px;
    position: relative;
    }

    @media print {
    .action-bar {
        display: none;
    }
    }





    @media print {
        canvas {
        min-height: 100%;
        max-width: 100%;
        max-height: 100%;
        height: auto !important;
        width: auto !important;
    }

    .row {
        display: flex;
        justify-content: center;
    }

    .col-6 {
        width: 50%;
    }

    h2 {
        page-break-before: always;
    }

    .tooltip {
        display: none;
    }

    }

        .co1 {
    width: 106px;
    }
    .co2 {
    width: 96px;
    }
    .co3 {
    width: 58px;
    }
    .co4 {
    width: 74px;
    }
    .co5 {
    width: 80px;
    }
    .co6 {
    width: 85px;
    }
    .co7 {
    width: 110px;
    }
    .ro1 {
    height: 17px;
    }
    .ro2 {
    height: 17px;
    }
    .ce1 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    }
    .ce2 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    color: #0070c0;
    font-weight: bold;
    }
    .ce3 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    }
    .ce4 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    color: #0070c0;
    }
    .ce5 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    color: #0070c0;
    }
    .ce6 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    color: #0070c0;
    font-weight: bold;
    }
    .ce7 {
    font-size: 13px;
    background-color: transparent;
    }
    .ce8 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    }
    .ce9 {
    font-size: 13px;
    background-color: transparent;
    text-align: start;
    color: #0070c0;
    font-weight: bold;
    }
    .ce10 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #ff0000;
    }
    .ce11 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    font-weight: bold;
    }
    .ce12 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    }
    .ce13 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #ff0000;
    }
    .ce14 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    }
    .ce15 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    font-weight: bold;
    }
    .ce16 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #ff0000;
    }
    .ce17 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    font-weight: bold;
    }
    .ce18 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    }
    .ce19 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    font-weight: bold;
    }
    .ce20 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    }
    .ce21 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    }
    .ce22 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    }
    .ce23 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    color: #0070c0;
    font-weight: bold;
    }
    .ce24 {
    background-color: transparent;
    border: none;
    text-align: center;
    font-size: 13px;
    }
    .ce25 {
    font-size: 13px;
    background-color: transparent;
    }
    .ce26 {
    font-size: 13px;
    background-color: transparent;
    }
    .ce27 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    }
    .ce28 {
    font-size: 13px;
    background-color: transparent;
    font-weight: bold;
    }
    .ce29 {
    font-size: 13px;
    background-color: transparent;
    text-align: center;
    font-weight: bold;
    }
    .ce30 {
    font-size: 13px;
    background-color: transparent;
    border: 0.74pt solid #000000;
    text-align: start;
    color: #0070c0;
    }
    .ce31 {
    background-color: transparent;
    border: 0.74pt solid #ffff00;
    text-align: center;
    font-size: 13px;
    font-style: italic;
    }
    .ce32 {
    background-color: transparent;
    border: 0.74pt solid #ffff00;
    text-align: center;
    font-size: 13px;
    }
    .ce33 {
    background-color: transparent;
    border: 0.74pt solid #000000;
    text-align: center;
    color: #0070c0;
    font-size: 13px;
    }
    .ce34 {
    background-color: transparent;
    border: 0.74pt solid #ffff00;
    text-align: center;
    font-size: 13px;
    }
    .ce35 {
    font-size: 13px;
    background-color: transparent;
    border: 0.74pt solid #000000;
    text-align: center;
    color: #0070c0;
    }
    .ce36 {
    font-size: 13px;
    background-color: transparent;
    border: 0.74pt solid #ffff00;
    text-align: center;
    font-style: italic;
    }
    .ce37 {
    font-size: 13px;
    background-color: transparent;
    border: 0.74pt solid #ffff00;
    text-align: center;
    }
    .Default {
    font-size: 15px;
    }
    .Heading {
    font-size: 32px;
    font-weight: bold;
    }
    .Heading_20_1 {
    font-size: 24px;
    font-weight: bold;
    }
    .Heading_20_2 {
    font-size: 16px;
    font-weight: bold;
    }
    .Text {
    font-size: 15px;
    }
    .Note {
    font-size: 15px;
    background-color: #ffffcc;
    border: 0.74pt solid #808080;
    color: #333333;
    }
    .Footnote {
    font-size: 15px;
    color: #808080;
    font-style: italic;
    }
    .Hyperlink {
    font-size: 15px;
    color: #0000ee;
    text-decoration: underline;
    }
    .Status {
    font-size: 15px;
    }
    .Good {
    font-size: 15px;
    background-color: #ccffcc;
    color: #006600;
    }
    .Neutral {
    font-size: 15px;
    background-color: #ffffcc;
    color: #996600;
    }
    .Bad {
    font-size: 15px;
    background-color: #ffcccc;
    color: #cc0000;
    }
    .Warning {
    font-size: 15px;
    color: #cc0000;
    }
    .Error {
    font-size: 15px;
    background-color: #cc0000;
    color: #ffffff;
    font-weight: bold;
    }
    .Accent {
    font-size: 15px;
    font-weight: bold;
    }
    .Accent_20_1 {
    font-size: 15px;
    font-weight: bold;
    color: #ffffff;
    }
    .Accent_20_2 {
    font-size: 15px;
    font-weight: bold;
    background-color: #808080;
    color: #ffffff;
    }
    .Accent_20_3 {
    font-size: 15px;
    font-weight: bold;
    background-color: #dddddd;
    }
    .Result {
    font-size: 15px;
    font-style: italic;
    text-decoration: underline;
    font-weight: bold;
    }
    .Excel_20_Built-in_20_Comma {
    font-size: 15px;
    }


    </style>
  </head>
  <body>
    <div class="cruzserrx3">
      <div class="application-layout-fluid application-align-left">
        <div class="application">
          <ul class="nav">
            <li class="nav-item active">
              <a href="#sheet1">SURVEY-DST</a>
            </li>
          </ul>
          <div class="tabs">
            <div id="sheet1" class="tab-content show ta1">
              <table>
                <colgroup>
                  <col span="1" class="co1">
                  <col span="1" class="co2">
                  <col span="1" class="co3">
                  <col span="1" class="co4">
                  <col span="1" class="co5">
                  <col span="1" class="co4">
                  <col span="1" class="co6">
                  <col span="1" class="co7">
                  <col span="1" class="co6">
                </colgroup>
                <tbody>
                  <tr class="s0r0 ro1">
                    <td class="s0r0c0 text ce1">
                      <p>
                        DISTANCE
                      </p>
                    </td>
                    <td class="s0r0c1 in ce10">
                      <input id="s0r0c1" inputmode="decimal">
                    </td>
                    <td class="s0r0c2 text ce18">
                      <p>
                        M
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r1 ro1">
                    <td class="s0r1c0 text ce1">
                      <p>
                        TIME
                      </p>
                    </td>
                    <td class="s0r1c1 in ce10">
                      <input id="s0r1c1" inputmode="decimal">
                    </td>
                    <td class="s0r1c2 text ce18">
                      <p>
                        MIN
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r2 ro1">
                    <td class="s0r2c0 text ce2">
                      <p>
                        SPEED
                      </p>
                    </td>
                    <td class="s0r2c1 out ce11">
                      <div id="s0r2c1"></div>
                    </td>
                    <td class="s0r2c2 text ce19">
                      <p>
                        KTS
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r3 ro2">
                    <td></td>
                  </tr>
                  <tr class="s0r4 ro1">
                    <td class="s0r4c0 text ce3">
                      <p>
                        DISTANCE
                      </p>
                    </td>
                    <td class="s0r4c1 in ce13">
                      <input id="s0r4c1" inputmode="decimal">
                    </td>
                    <td class="s0r4c2 text ce20">
                      <p>
                        N/M
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r5 ro1">
                    <td class="s0r5c0 text ce1">
                      <p>
                        SPEED
                      </p>
                    </td>
                    <td class="s0r5c1 in ce13">
                      <input id="s0r5c1" inputmode="decimal">
                    </td>
                    <td class="s0r5c2 text ce21">
                      <p>
                        KTS
                      </p>
                    </td>
                    <td class="s0r5c3 text ce25"></td>
                    <td class="s0r5c4 text ce25"></td>
                    <td class="s0r5c5 text ce25"></td>
                    <td class="s0r5c6 text ce30 hidden-cell">
                      <p>
                        S/TIME
                      </p>
                    </td>
                    <td class="s0r5c7 out ce33 hidden-cell">
                      <div id="s0r5c7"></div>
                    </td>
                    <td class="s0r5c8 text ce35 hidden-cell">
                      <p>
                        hr
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r6 ro1">
                    <td class="s0r6c0 text ce4">
                      <p>
                        DAYS
                      </p>
                    </td>
                    <td class="s0r6c1 out ce14">
                      <div id="s0r6c1"></div>
                    </td>
                    <td class="s0r6c2 text ce22">
                      <p>
                        D
                      </p>
                    </td>
                    <td class="s0r6c3 text ce25"></td>
                    <td class="s0r6c4 text ce25"></td>
                    <td class="s0r6c5 text ce25"></td>
                    <td class="s0r6c6 text ce31 hidden-cell">
                      <p>
                        DAYS
                      </p>
                    </td>
                    <td class="s0r6c7 text ce31 hidden-cell">
                      <p>
                        HRS
                      </p>
                    </td>
                    <td class="s0r6c8 text ce36 hidden-cell">
                      <p>
                        MIN
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r7 ro1">
                    <td class="s0r7c0 text ce5">
                      <p>
                        HRS
                      </p>
                    </td>
                    <td class="s0r7c1 out ce14">
                      <div id="s0r7c1"></div>
                    </td>
                    <td class="s0r7c2 text ce22">
                      <p>
                        H
                      </p>
                    </td>
                    <td class="s0r7c3 text ce7"></td>
                    <td class="s0r7c4 text ce7"></td>
                    <td class="s0r7c5 text ce7"></td>
                    <td class="s0r7c6 out ce32 hidden-cell">
                      <div id="s0r7c6"></div>
                    </td>
                    <td class="s0r7c7 out ce34 hidden-cell">
                      <div id="s0r7c7"></div>
                    </td>
                    <td class="s0r7c8 out ce37 hidden-cell">
                      <div id="s0r7c8"></div>
                    </td>
                  </tr>
                  <tr class="s0r8 ro1">
                    <td class="s0r8c0 text ce6">
                      <p>
                        MIN
                      </p>
                    </td>
                    <td class="s0r8c1 out ce15">
                      <div id="s0r8c1"></div>
                    </td>
                    <td class="s0r8c2 text ce23">
                      <p>
                        M
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r9 ro1">
                    <td></td>
                  </tr>
                  <tr class="s0r10 ro1">
                    <td class="s0r10c0 text ce1">
                      <p>
                        DISTANCE(M)
                      </p>
                    </td>
                    <td class="s0r10c1 in ce10">
                      <input id="s0r10c1" inputmode="decimal">
                    </td>
                    <td class="s0r10c2 text ce18">
                      <p>
                        M
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r11 ro1">
                    <td class="s0r11c0 text ce8">
                      <p>
                        SPEED (KTS)
                      </p>
                    </td>
                    <td class="s0r11c1 in ce16">
                      <input id="s0r11c1" inputmode="decimal">
                    </td>
                    <td class="s0r11c2 text ce21">
                      <p>
                        KTS
                      </p>
                    </td>
                  </tr>
                  <tr class="s0r12 ro1">
                    <td class="s0r12c0 text ce9">
                      <p>
                        TIME (MIN)
                      </p>
                    </td>
                    <td class="s0r12c1 out ce17">
                      <div id="s0r12c1"></div>
                    </td>
                    <td class="s0r12c2 text ce19">
                      <p>
                        MIN
                      </p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="action-bar">
          <button class="btn" onclick="window.print()">Print</button> <label class="btn" for="data-file">Load</label> <input id="data-file" type="file" style="display: none;" onchange="APY.onDataFileSelected()"> <button class="btn" onclick="APY.onSaveButtonClicked()">Save</button>
        </div>
      </div>
    </div><!-- Vendor libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/@formulajs/formulajs@4.3.4/lib/browser/formula.min.js"></script> 
    <script type="application/javascript">

            

            (function (window) {
                window.numeral.locale('');
            })(this);
    </script> 
    <script type="application/javascript">

        function ready(fn) {
    if (document.readyState !== 'loading') {
        fn();
    } else {
        document.addEventListener('DOMContentLoaded', fn);
    }
    }

    ready(function () {
        const APY = {};

    APY.config = {
    }

    APY.cells = {};


            APY.cells.s0r0c0 = {v: 'DISTANCE',
                t: 'text',
                f: ''
            };
    APY.cells.s0r0c1 = {v: 500,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r0c2 = {v: 'M',
                t: 'text',
                f: ''
            };
                APY.cells.s0r1c0 = {v: 'TIME\u0020',
                t: 'text',
                f: ''
            };
    APY.cells.s0r1c1 = {v: 30,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r1c2 = {v: 'MIN',
                t: 'text',
                f: ''
            };
                APY.cells.s0r2c0 = {v: 'SPEED',
                t: 'text',
                f: ''
            };
    APY.cells.s0r2c1 = {v: 0.539956803455724,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r2c2 = {v: 'KTS',
                t: 'text',
                f: ''
            };
                APY.cells.s0r4c0 = {v: 'DISTANCE',
                t: 'text',
                f: ''
            };
    APY.cells.s0r4c1 = {v: 1477,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r4c2 = {v: 'N\/M',
                t: 'text',
                f: ''
            };
                APY.cells.s0r5c0 = {v: 'SPEED',
                t: 'text',
                f: ''
            };
    APY.cells.s0r5c1 = {v: 1,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r5c2 = {v: 'KTS',
                t: 'text',
                f: ''
            };
                APY.cells.s0r5c6 = {v: 'S\/TIME',
                t: 'text',
                f: ''
            };
    APY.cells.s0r5c7 = {v: 1477,
                t: 'number',
                f: '0,0.00'
            };                APY.cells.s0r5c8 = {v: 'hr',
                t: 'text',
                f: ''
            };
                APY.cells.s0r6c0 = {v: 'DAYS',
                t: 'text',
                f: ''
            };
    APY.cells.s0r6c1 = {v: 61,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r6c2 = {v: 'D',
                t: 'text',
                f: ''
            };
                APY.cells.s0r6c6 = {v: 'DAYS',
                t: 'text',
                f: ''
            };
                APY.cells.s0r6c7 = {v: 'HRS',
                t: 'text',
                f: ''
            };
                APY.cells.s0r6c8 = {v: 'MIN',
                t: 'text',
                f: ''
            };
                APY.cells.s0r7c0 = {v: 'HRS',
                t: 'text',
                f: ''
            };
    APY.cells.s0r7c1 = {v: 12,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r7c2 = {v: 'H',
                t: 'text',
                f: ''
            };
    APY.cells.s0r7c6 = {v: 61.5416666666667,
                t: 'number',
                f: '0,0.0000'
            };    APY.cells.s0r7c7 = {v: 12.9999999999999,
                t: 'number',
                f: '0,0.000'
            };    APY.cells.s0r7c8 = {v: 59.9999999999966,
                t: 'number',
                f: '0,0.0000'
            };                APY.cells.s0r8c0 = {v: 'MIN',
                t: 'text',
                f: ''
            };
    APY.cells.s0r8c1 = {v: 60,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r8c2 = {v: 'M',
                t: 'text',
                f: ''
            };
                APY.cells.s0r10c0 = {v: 'DISTANCE\u0028M\u0029',
                t: 'text',
                f: ''
            };
    APY.cells.s0r10c1 = {v: 500,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r10c2 = {v: 'M',
                t: 'text',
                f: ''
            };
                APY.cells.s0r11c0 = {v: 'SPEED\u0020\u0028KTS\u0029',
                t: 'text',
                f: ''
            };
    APY.cells.s0r11c1 = {v: 0.539956803455724,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r11c2 = {v: 'KTS',
                t: 'text',
                f: ''
            };
                APY.cells.s0r12c0 = {v: 'TIME\u0020\u0028MIN\u0029',
                t: 'text',
                f: ''
            };
    APY.cells.s0r12c1 = {v: 30,
                t: 'number',
                f: '0.00'
            };                APY.cells.s0r12c2 = {v: 'MIN',
                t: 'text',
                f: ''
            };

        
        APY.formulas = {
                                            s0r2c1: function() { APY.set('s0r2c1',(APY.RANGE([0,0,1])/1852)/(APY.RANGE([0,1,1])/60)) },
                                                        s0r5c7: function() { APY.set('s0r5c7',formulajs.ROUND((APY.RANGE([0,4,1])/APY.RANGE([0,5,1])),2)) },
                                                        s0r6c1: function() { APY.set('s0r6c1',formulajs.INT(APY.RANGE([0,7,6]))) },
                                                        s0r7c1: function() { APY.set('s0r7c1',formulajs.INT(APY.RANGE([0,7,7]))) },
                                                        s0r7c6: function() { APY.set('s0r7c6',APY.RANGE([0,5,7])/24) },
                                                        s0r7c7: function() { APY.set('s0r7c7',(APY.RANGE([0,7,6])-(formulajs.INT(APY.RANGE([0,7,6]))))*24) },
                                                        s0r7c8: function() { APY.set('s0r7c8',(APY.RANGE([0,7,7])-formulajs.INT(APY.RANGE([0,7,7])))*60) },
                                                        s0r8c1: function() { APY.set('s0r8c1',formulajs.ROUND(APY.RANGE([0,7,8]),2)) },
                                                        s0r12c1: function() { APY.set('s0r12c1',((APY.RANGE([0,10,1])/1852)/APY.RANGE([0,11,1]))*60) },
                            };

        APY.calculate = function () {
                                        // Step 1
                                APY.formulas.s0r2c1();
                                APY.formulas.s0r5c7();
                                APY.formulas.s0r7c6();
                                APY.formulas.s0r7c7();
                                APY.formulas.s0r7c8();
                                APY.formulas.s0r8c1();
                                APY.formulas.s0r12c1();
                                            // Step 2
                                APY.formulas.s0r6c1();
                                APY.formulas.s0r7c1();
                                                    
            
                    };

    APY.getValue = function (value, type, format) {
        type = type ? type : 'text';
        let returnedValue;
        if (type === 'boolean') {
            returnedValue = (value === 'true');
        } else if (type === 'number') {
            returnedValue = numeral(value).value();
        } else if (type === 'date') {
            const m = format ? moment(value, format) : moment(value);
            if (!!value && m.isValid()) {
                returnedValue = m.toDate();
            } else {
                returnedValue = null;
            }
        } else {
            returnedValue = value;
        }

        return returnedValue;
    };

    APY.set = function (cellId, value, parseValue = false) {
        const isCellAddress = /s\d*r\d*c\d*/.test(cellId);
        let cell;
        if (isCellAddress) {
            cell = APY.cells[cellId];
            if (!cell) {
                return;
            }
        } else {
            const cellIds = Object.keys(APY.cells).filter(function (cell) {
                return APY.cells[cell].name === cellId;
            });

            if (cellIds.length > 0) {
                cell = APY.cells[cellIds[0]];
                cellId = cellIds[0];
            } else {
                return;
            }
        }

        if (parseValue) {
            value = APY.getValue(value, cell.t, '');
        }

        cell.v = value;

        const cellElement = document.getElementById(cellId);
        if (!cellElement) {
            return;
        }

        if (APY.config.clearZeroInputs && cell.v === 0 && cellElement.matches('input')) {
            cellElement.value = null;
            return;
        }

        const displayedValue = APY.formatValue(value, cell.t, cell.f);
        if (cellElement.matches('div')) {
            cellElement.innerHTML = displayedValue;
            const output = document.getElementById(cellId + '-out');
            if (output) {
                output.value = displayedValue;
            }
        } else {
            cellElement.value = displayedValue;
        }
    };

    APY.setMatrix = function (cellId, value, matrixColumnsSpanned = 1, matrixRowsSpanned = 1) {
        for (let collOffset = 0; collOffset < matrixColumnsSpanned; collOffset++) {
            for (let rowOffSet = 0; rowOffSet < matrixRowsSpanned; rowOffSet++) {
                const regex = /s(\d+)r(\d+)c(\d+)/;
                const result = cellId.replace(regex, function (match, sheet, row, col) {
                    return 's' + sheet + 'r' + (parseInt(row, 10) + rowOffSet) + 'c' + (parseInt(col, 10) + collOffset);
                });

                APY.set(result, value[rowOffSet])
            }
        }
    };

    APY.formatValue = function (value, type, format) {
        if (value instanceof Error) {
            return value.toString();
        }

        let formattedValue;
        if (value === null) {
            formattedValue = '';
        } else {
            formattedValue = value + '';
        }

        if (type === 'number') {
            if (value === null) {
                return '';
            }
            format = format ? format : '0.[000000000]';
            value = Math.abs(value) <= 1e-7 ? 0 : value;
            formattedValue = numeral(value).format(format);
        }

        if (type === 'date') {
            if (!value) {
                return value;
            }

            formattedValue = moment(value).format(format);
        }

        return formattedValue;
    };

    APY.getInputs = function () {
        const inputs = {};
        const applicationInputs = document.querySelectorAll('.application input:not([type="hidden"]), .application select, .application textarea');
        applicationInputs.forEach(function (inputElement) {
            let cellId = inputElement.id
            const cell = APY.cells[cellId];

            if (cell) {
                let value = cell.v;

                if (value instanceof Date) {
                    value = APY.dateToString(value);
                }

                // Use named range instead of cell location id
                if (cell.name) {
                    cellId = cell.name;
                }

                inputs[cellId] = {
                    value: value,
                    type: cell.t
                };
            }
        });

        return inputs;
    };

    APY.setInputs = function (data) {
        Object.keys(data).forEach(function (key) {
            if (data.hasOwnProperty(key)) {
                let value = data[key]?.value ?? data[key];
                APY.set(key, value, true);
            }
        });
    };

    APY.dateToString = function (date) {
        return date.getFullYear() + '-' +
            ((date.getMonth() + 1) < 10 ? '0' : '') +
            (date.getMonth() + 1) + '-' +
            (date.getDate() < 10 ? '0' : '') +
            date.getDate() +
            'T' +
            (date.getHours() < 10 ? '0' : '') +
            date.getHours() +
            ':' +
            (date.getMinutes() < 10 ? '0' : '') +
            date.getMinutes() +
            ':' +
            (date.getSeconds() < 10 ? '0' : '') +
            date.getSeconds();
    };

    APY.RANGE = function () {
        let value = null;
        if (arguments.length === 1) {
            const cellId = 's' + arguments[0][0] + 'r' + arguments[0][1] + 'c' + arguments[0][2];

            if (APY.cells && APY.cells.hasOwnProperty(cellId)) {
                value = APY.cells[cellId].v;
            }

            return value;
        } else if (arguments.length === 2) {
            const values = [];
            const head = arguments[0];
            const tail = arguments[1];
            for (let i = 0; i <= (tail[1] - head[1]); i++) {
                const row = [];
                for (let j = 0; j <= tail[2] - head[2]; j++) {
                    value = null;
                    const cellId = 's' + head[0] + 'r' + (head[1] + i) + 'c' + (head[2] + j);

                    if (APY.cells && APY.cells.hasOwnProperty(cellId)) {
                        value = APY.cells[cellId].v;
                    }
                    row.push(value);
                }
                values.push(row);
            }

            return values;
        }
    };

    APY.onSaveButtonClicked = function () {
        const blob = new Blob([JSON.stringify(APY.getInputs())], {type: 'application/json'});
        const fileName = document.title + ' ' + (new Date()).toISOString().slice(0, 10) + '.json';
        const url = window.URL.createObjectURL(blob);

        if (window.navigator && window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveOrOpenBlob(blob, fileName);
        } else {
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
        }
    };

    APY.onDataFileSelected = function () {
        const file = document.getElementById('data-file');
        const blob = file.files[0];
        if (blob) {
            const reader = new FileReader();

            reader.onload = function (evt) {
                APY.setInputs(JSON.parse(evt.target.result));
                APY.calculate();
            };

            reader.onerror = function (evt) {
                console.error("An error occurred reading the file", evt);
            };

            reader.readAsText(blob, "UTF-8");
        }
    };

    APY.onCalculateButtonClicked = function () {
        APY.calculate();
    };

    APY.onSendButtonClicked = function () {
        document.querySelector('form.application').requestSubmit();
    };

    formulajs.OFFSET = function (reference, rows, cols, height, width) {
        rows = rows >= 0 ? rows : 0;
        cols = cols >= 0 ? cols : 0;
        height = height >= 1 ? height : 1;
        width = width >= 1 ? width : 1;

        if (width === 1 && height === 1) {
            return APY.RANGE([reference[0], reference[1] + rows, reference[2] + cols]);
        } else {
            return APY.RANGE(
                [reference[0], reference[1] + rows, reference[2] + cols],
                [reference[0], reference[1] + rows + height - 1, reference[2] + cols + width - 1]
            );
        }
    };

    formulajs.HYPERLINK = function (url, text) {
        text = text === undefined ? url : text;
        return '<a href="' + url + '" target="_blank">' + text + '<\/a>';
    };

    // Expose cruzserrx3 App API called APY :)
    window.APY = APY;


    APY.init = function () {
        const applicationInputs = document.querySelectorAll('.application input:not([type="hidden"]), .application select, .application textarea');

        // Update values in input fields on change
        applicationInputs.forEach(function (inputElement) {
            inputElement.addEventListener('change', function (event) {
                const cell = APY.cells[event.target.id];
                cell.v = APY.getValue(event.target.value, cell.t, cell.f);
                inputElement.value = APY.formatValue(cell.v, cell.t, cell.f);

                                APY.calculate();
                            })
        });

        // Display formatted values in input fields on application start
        applicationInputs.forEach(function (inputElement) {
            var cell = APY.cells[inputElement.id];
            // Recompute Office value in Javascript value
            cell.value = APY.getValue(cell.v, cell.t);

            
            inputElement.value = APY.formatValue(cell.v, cell.t, cell.f);
        });

        APY.calculate();
    };

 

    });
    </script>
  </body>
</html>